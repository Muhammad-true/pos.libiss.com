import{t as i}from"./styles-DXc76zUi.js";const E="https://api.libiss.com/api/v1",h="libiss-pos-lang",w="ru",L=Array.from(document.querySelectorAll("[data-i18n]")),k=Array.from(document.querySelectorAll("[data-i18n-attr]")),A=Array.from(document.querySelectorAll(".lang-btn")),l=document.querySelector("[data-form]"),u=document.querySelector("[data-status]"),f=()=>{const t=localStorage.getItem(h);return t&&i[t]?t:navigator.language.toLowerCase().startsWith("ru")?"ru":"en"},b=t=>{const e=i[t]||i[w];L.forEach(r=>{const s=r.dataset.i18n;e[s]&&(r.textContent=e[s])}),k.forEach(r=>{const s=r.dataset.i18nAttr,n=r.dataset.i18nKey;s&&n&&e[n]&&r.setAttribute(s,e[n])}),document.documentElement.lang=t,A.forEach(r=>{r.classList.toggle("is-active",r.dataset.lang===t)}),localStorage.setItem(h,t)};A.forEach(t=>{t.addEventListener("click",()=>{const e=t.dataset.lang;e&&b(e)})});const a=(t,e)=>{u&&(u.textContent=t,u.classList.toggle("is-error",e==="error"),u.classList.toggle("is-success",e==="success"))},v=async t=>{var n,g,m,y,p,S;if(t.preventDefault(),!l)return;a("","");const e=new FormData(l),r={phone:(n=e.get("phone"))==null?void 0:n.toString().trim(),password:(g=e.get("password"))==null?void 0:g.toString()},s=l.querySelector("button[type='submit']");s&&(s.disabled=!0);try{const c=await fetch(`${E}/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)});if(!c.ok){const d=i[f()];c.status===400?a(d["login.error400"],"error"):c.status===401?a(d["login.error401"],"error"):c.status===404?a(d["login.error404"],"error"):a(d["login.error500"],"error");return}const o=await c.json();(m=o==null?void 0:o.data)!=null&&m.token&&localStorage.setItem("userToken",o.data.token),(y=o==null?void 0:o.data)!=null&&y.user&&localStorage.setItem("userData",JSON.stringify(o.data.user)),(S=(p=o==null?void 0:o.data)==null?void 0:p.shop)!=null&&S.id&&localStorage.setItem("shopId",o.data.shop.id),a(i[f()]["login.success"],"success"),window.location.href="/office.html"}catch{a(i[f()]["login.error"],"error")}finally{s&&(s.disabled=!1)}};l&&l.addEventListener("submit",v);b(f());
